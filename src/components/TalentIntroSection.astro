---
export interface Props {
  title: string;
  subtitle: string | null;
  text: string;
  action: string | null;
  images: string[];
  imagePosition: "left" | "right";
  background: "black" | "white";
  textColor: "black" | "white";
  alt: string[];
}

const {
  title,
  subtitle,
  text,
  action,
  images,
  alt,
  imagePosition,
  background,
  textColor,
} = Astro.props;

const flexDirection =
  imagePosition === "left" ? "flex-row-reverse" : "flex-row";
const bgClass = background === "black" ? "bg-zinc-700" : "bg-white";
const textClass = textColor === "white" ? "text-white" : "text-black";

// Generar un ID únic per al carrusel
const carouselId = `carousel-${Math.random().toString(36).substr(2, 9)}`;
---

<section class={`${bgClass} w-screen lg:flex items-center justify-center`}>
  <div class={`lg:flex ${flexDirection} w-full`}>
    <!-- Contingut de text -->
    <div class="lg:w-1/2 flex flex-col justify-between gap-48">
      <div class={`${textClass} px-8 py-12`}>
        <h2
          class={`text-6xl mb-12 whitespace-pre-line font-medium`}
          set:html={title}
        />
        <p class={`text-4xl my-12 font-medium`} set:html={subtitle} />
        <div class={`text-2xl font-light`} set:html={text} />
      </div>
      <p class={`${textClass} p-8 text-2xl font-medium`} set:html={action} />
    </div>

    <!-- Imatge amb carrusel -->
    <div class="lg:w-1/2 relative overflow-hidden">
      <!-- Carrusel d'imatges -->
      <div id={carouselId} class="w-full h-full relative">
        {
          images.map((image, index) => (
            <img
              src={image}
              alt={alt[index]}
              class={`absolute inset-0 w-full h-full object-cover transition-opacity duration-500 ${
                index === 0 ? "opacity-100" : "opacity-0"
              }`}
              data-index={index}
            />
          ))
        }
      </div>

      <!-- Indicadors del carrusel -->
      <div
        class="absolute bottom-4 left-1/2 transform -translate-x-1/2 flex space-x-2"
      >
        {
          images.map((_, index) => (
            <button
              class={`w-3 h-3 rounded-full transition-all ${
                index === 0 ? "bg-white" : "bg-white bg-opacity-50"
              }`}
              data-index={index}
              aria-label={`Anar a imatge ${index + 1}`}
            />
          ))
        }
      </div>

      <!-- Botons de navegació del carrusel -->
      <button
        class="carousel-prev absolute left-4 top-1/2 transform -translate-y-1/2 p-2 bg-white bg-opacity-20 rounded-full hover:bg-opacity-30 transition-all z-10"
        aria-label="Imatge anterior"
      >
        <svg
          class="w-6 h-6 text-white"
          fill="none"
          stroke="currentColor"
          viewBox="0 0 24 24"
        >
          <path
            stroke-linecap="round"
            stroke-linejoin="round"
            stroke-width="2"
            d="M15 19l-7-7 7-7"></path>
        </svg>
      </button>

      <button
        class="carousel-next absolute right-4 top-1/2 transform -translate-y-1/2 p-2 bg-white bg-opacity-20 rounded-full hover:bg-opacity-30 transition-all z-10"
        aria-label="Imatge següent"
      >
        <svg
          class="w-6 h-6 text-white"
          fill="none"
          stroke="currentColor"
          viewBox="0 0 24 24"
        >
          <path
            stroke-linecap="round"
            stroke-linejoin="round"
            stroke-width="2"
            d="M9 5l7 7-7 7"></path>
        </svg>
      </button>
    </div>
  </div>
</section>
