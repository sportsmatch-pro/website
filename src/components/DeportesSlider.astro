---
import LogoIcon from "./LogoIcon.astro";

export interface Props {
  currentLang?: string;
  title?: string;
}

const { currentLang = "es-ES" } = Astro.props;

// Traduccions per a cada idioma
const translations = {
  "es-ES": {
    title: "SportsMatch - Tu sueño, a tu alcance",
    heroText:
      "Únete a la primera red social del mercado que conecta jugador@s y profesionales del deporte con clubes deportivos",
    sports: [
      { nombre: "Fútbol", color: "#22c55e", imagen: "/assets/futbol.png" },
      { nombre: "Baloncesto", color: "#f97316", imagen: "/assets/basket.png" },
      { nombre: "Hockey", color: "#eab308", imagen: "/assets/hockey.png" },
      { nombre: "Fútbol sala", color: "#3b82f6", imagen: "/assets/futsal.png" },
      { nombre: "Voleibol", color: "#ec4899", imagen: "/assets/voleibol.png" },
      {
        nombre: "Balonmano",
        color: "#7c3aed",
        imagen: "/assets/balonmano.png",
      },
    ],
  },
  "ca-ES": {
    title: "SportsMatch - El teu somni, a l'abast",
    heroText:
      "Uneix-te a la primera xarxa social del mercat que connecta jugadors i professionals de l'esport amb clubs esportius",
    sports: [
      { nombre: "Futbol", color: "#22c55e", imagen: "/assets/futbol.png" },
      { nombre: "Bàsquet", color: "#f97316", imagen: "/assets/basket.png" },
      { nombre: "Hoquei", color: "#eab308", imagen: "/assets/hockey.png" },
      { nombre: "Futbol sala", color: "#3b82f6", imagen: "/assets/futsal.png" },
      { nombre: "Voleibol", color: "#ec4899", imagen: "/assets/voleibol.png" },
      { nombre: "Handbol", color: "#7c3aed", imagen: "/assets/balonmano.png" },
    ],
  },
  en: {
    title: "SportsMatch - Your dream, at your reach",
    heroText:
      "Join the first social network in the market that connects players and sports professionals with sports clubs",
    sports: [
      { nombre: "Football", color: "#22c55e", imagen: "/assets/futbol.png" },
      { nombre: "Basketball", color: "#f97316", imagen: "/assets/basket.png" },
      { nombre: "Hockey", color: "#eab308", imagen: "/assets/hockey.png" },
      { nombre: "Futsal", color: "#3b82f6", imagen: "/assets/futsal.png" },
      {
        nombre: "Volleyball",
        color: "#ec4899",
        imagen: "/assets/voleibol.png",
      },
      { nombre: "Handball", color: "#7c3aed", imagen: "/assets/balonmano.png" },
    ],
  },
};

const t =
  translations[currentLang as keyof typeof translations] ||
  translations["es-ES"];
---

<style>
  /* Estils específics per a DeportesSlider */
  .sport-transition {
    transition: all 0.5s ease-in-out;
  }

  .arrow-button {
    backdrop-filter: blur(10px);
    background: rgba(255, 255, 255, 0.1);
  }

  .arrow-button:hover {
    background: rgba(255, 255, 255, 0.2);
    transform: scale(1.1);
  }

  .color-capitalized span {
    color: #22c55e;
  }
</style>

<div
  class="-mt-20 relative h-screen w-full overflow-hidden flex items-center justify-center bg-black"
  data-current-lang={currentLang}
>
  <!-- Imatge de fons dinàmica -->
  <img
    id="sport-background"
    src="/assets/futbol.png"
    alt="Fútbol"
    class="absolute inset-0 w-full h-full object-cover sport-transition"
  />

  <!-- Text principal -->
  <div
    class="absolute left-0 w-full h-full lg:w-2/3 flex flex-col justify-start lg:justify-center items-start pt-40 lg:pl-40 p-10 text-left z-30"
  >
    <h1
      class="font-bold text-white text-vw-xl leading-vw-xl lg:text-vw-base lg:leading-vw-base"
    >
      {t.title}
    </h1>
    <p
      class="font-thin text-white text-vw-xl leading-vw-xl lg:text-vw-base lg:leading-vw-base"
    >
      {t.heroText}
    </p>
  </div>

  <!-- LogoIcon centrat amb animació -->
  <div
    id="logo-container"
    class="absolute left-0 w-1/2 left-1/4 h-full lg:w-1/4 lg:left-2/3 flex justify-center items-center pt-40 lg:pt-20 p-0 z-20 animate-pulse-strong"
  >
    <LogoIcon
      responsive={true}
      responsiveWidth="80%"
      responsiveMaxHeight="50%"
      color="#ffffff"
      secondaryColor="#ffffff"
    />
  </div>

  <!-- Nom del esport -->
  <div
    class="color-capitalized absolute bottom-8 right-8 text-white font-bold text-6xl z-30"
  >
    <span>F</span>útbol
  </div>

  <!-- Fletxes de navegació -->
  <button
    id="prev-button"
    class="absolute left-4 z-30 p-4 mt-20 text-white hover:text-gray-300 transition-colors arrow-button"
  >
    <svg class="w-8 h-8" fill="none" stroke="currentColor" viewBox="0 0 24 24">
      <path
        stroke-linecap="round"
        stroke-linejoin="round"
        stroke-width="2"
        d="M15 19l-7-7 7-7"></path>
    </svg>
  </button>

  <button
    id="next-button"
    class="absolute right-4 z-30 p-4 mt-20 text-white hover:text-gray-300 transition-colors arrow-button"
  >
    <svg class="w-8 h-8" fill="none" stroke="currentColor" viewBox="0 0 24 24">
      <path
        stroke-linecap="round"
        stroke-linejoin="round"
        stroke-width="2"
        d="M9 5l7 7-7 7"></path>
    </svg>
  </button>
</div>

<script>
  // Obtenir les traduccions del servidor
  const currentLang =
    document
      .querySelector("[data-current-lang]")
      ?.getAttribute("data-current-lang") || "es-ES";

  // Definir els esports segons l'idioma
  const getSportsByLanguage = (lang) => {
    const sports = {
      "es-ES": [
        {
          nombre: "<span>F</span>útbol",
          color: "#22c55e",
          imagen: "/assets/futbol.png",
        },
        {
          nombre: "<span>B</span>aloncesto",
          color: "#f97316",
          imagen: "/assets/basket.png",
        },
        {
          nombre: "<span>H</span>ockey",
          color: "#eab308",
          imagen: "/assets/hockey.png",
        },
        {
          nombre: "<span>F</span>útbol <span>S</span>ala",
          color: "#3b82f6",
          imagen: "/assets/futsal.png",
        },
        {
          nombre: "<span>V</span>oleibol",
          color: "#ec4899",
          imagen: "/assets/voleibol.png",
        },
        {
          nombre: "<span>B</span>alonmano",
          color: "#7c3aed",
          imagen: "/assets/balonmano.png",
        },
      ],
      "ca-ES": [
        {
          nombre: "<span>F</span>utbol",
          color: "#22c55e",
          imagen: "/assets/futbol.png",
        },
        {
          nombre: "<span>B</span>àsquet",
          color: "#f97316",
          imagen: "/assets/basket.png",
        },
        {
          nombre: "<span>H</span>oquei",
          color: "#eab308",
          imagen: "/assets/hockey.png",
        },
        {
          nombre: "<span>F</span>utbol <span>S</span>ala",
          color: "#3b82f6",
          imagen: "/assets/futsal.png",
        },
        {
          nombre: "<span>V</span>oleibol",
          color: "#ec4899",
          imagen: "/assets/voleibol.png",
        },
        {
          nombre: "<span>B</span>alonmano",
          color: "#7c3aed",
          imagen: "/assets/balonmano.png",
        },
      ],
      en: [
        {
          nombre: "<span>F</span>ootball",
          color: "#22c55e",
          imagen: "/assets/futbol.png",
        },
        {
          nombre: "<span>B</span>asketball",
          color: "#f97316",
          imagen: "/assets/basket.png",
        },
        {
          nombre: "<span>H</span>ockey",
          color: "#eab308",
          imagen: "/assets/hockey.png",
        },
        {
          nombre: "<span>F</span>utsal",
          color: "#3b82f6",
          imagen: "/assets/futsal.png",
        },
        {
          nombre: "<span>V</span>olleyball",
          color: "#ec4899",
          imagen: "/assets/voleibol.png",
        },
        {
          nombre: "<span>H</span>andball",
          color: "#7c3aed",
          imagen: "/assets/balonmano.png",
        },
      ],
    };
    return sports[lang] || sports["es-ES"];
  };

  const deportes = getSportsByLanguage(currentLang);

  let currentIndex = 0;
  const sportNameElement = document.querySelector(".absolute.bottom-8.right-8");
  const logoElement = document.querySelector("#logo-container svg");
  const backgroundImage = document.getElementById(
    "sport-background"
  ) as HTMLImageElement;

  function updateSport() {
    const deporte = deportes[currentIndex];
    if (sportNameElement) {
      sportNameElement.innerHTML = deporte.nombre;
      // apply deporte.color to all span children
      sportNameElement.querySelectorAll("span").forEach((span) => {
        span.style.color = deporte.color;
      });
    }
    if (backgroundImage) {
      backgroundImage.src = deporte.imagen;
      backgroundImage.alt = deporte.nombre;
    }
    if (logoElement) {
      // Canviar el color del logo
      const paths = logoElement.querySelectorAll("path");
      paths.forEach((path, index) => {
        const colorIndex = path.getAttribute("data-color");
        if (colorIndex === "1") {
          path.setAttribute("fill", deporte.color);
        }
      });
    }
  }

  function nextSport() {
    currentIndex = (currentIndex + 1) % deportes.length;
    updateSport();
  }

  // Canviar d'esport cada 5 segons
  setInterval(nextSport, 5000);

  // Event listeners per a les fletxes
  const prevButton = document.getElementById("prev-button");
  const nextButton = document.getElementById("next-button");

  if (prevButton) {
    prevButton.addEventListener("click", () => {
      currentIndex = (currentIndex - 1 + deportes.length) % deportes.length;
      updateSport();
    });
  }

  if (nextButton) {
    nextButton.addEventListener("click", () => {
      nextSport();
    });
  }

  // Inicialitzar
  updateSport();
</script>
